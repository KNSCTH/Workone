<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" 
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sarabun">
    <style>body {font-family: "Sarabun"; font-size: 16px;}th,td {text-align: center }</style>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏á‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
</head>

<body>
    <img src="https://firebasestorage.googleapis.com/v0/b/photo1-fd15a.appspot.com/o/%E0%B9%80%E0%B8%A7%E0%B9%87%E0%B8%9A%E0%B8%95%E0%B8%B1%E0%B8%A7%E0%B9%80%E0%B8%AD%E0%B8%87%2Fset2%2F%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%84%E0%B9%89%E0%B8%B2%E0%B8%87.jpg?alt=media&token=14a77d32-4cc6-4150-9cee-20fd39c775e1" class="img-fluid" alt="Responsive image">

       <body>      
     <a href="https://zh8pozwxjcwfgyfbvmnrqq-on.drv.tw/html%E0%B8%AA%E0%B8%B2%E0%B8%A2/News.MMLOP.V01M.3.html"><img src="https://firebasestorage.googleapis.com/v0/b/photo1-fd15a.appspot.com/o/%E0%B8%9B%E0%B8%81%E0%B8%82%E0%B9%88%E0%B8%B2%E0%B8%A7.gif?alt=media&token=92105097-a08d-4c9a-95a4-6fb4c80dff53" class="img-fluid" alt=""></a>
    <a href="https://web.facebook.com/informationcovid19"><img src="https://firebasestorage.googleapis.com/v0/b/photo1-fd15a.appspot.com/o/%E0%B8%9F%E0%B8%B3%E0%B8%9E%E0%B9%89%E0%B8%B0%E0%B8%AB%E0%B8%9E.gif?alt=media&token=f4a4964c-2aa3-4ec8-b313-ee5364aa6457" class="img-fluid" alt=""></a>      
       </body>


    <div class="container-fluid" align="center">
        <?var url = getUrl();?>
        <div>
            <label>‡πÇ‡∏õ‡∏£‡∏î‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô üîç</label><br>
            <input type="text" name="search" autocomplete="off" id="search" value="" />
            <button id="searchButton">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
        </div><br>
        <div id="resultdiv">
            <table class="table teble-hover" id="tableId" border="1" cellpadding="5px"></table>
            <div style="margin: 30px;">
                <a href="" id=""></a>
             <h6>üí°‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢üí°</h6>
            </div>
        </div>
        <h6>üí°‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏à‡πâ‡∏á‡∏°‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</h6>
    </div>

    <script>
        var tableData = [] 
        var tableHeaders = ['‡∏ß‡∏¥‡∏ä‡∏≤', '‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'] 
        window.onload = () => { 
            $('#resultdiv').hide() 
            google.script.run.withSuccessHandler(createTable).getSheetData() 
        }
            $('#searchButton').click(() => { 
            $('#resultdiv').show() 
            $('#tableId tr').remove() 

            let table = document.getElementById(" tableId") 
            let search = $("#search").val() 
            if (search == "") { 
               $('#resultdiv').hide() } 
  
               $('table').append(`<tr class="badge-success" id="nameCell"> </tr>`)
               $('table').append(`<tr id=""> </tr>`)
            //‡∏™‡∏£‡πâ‡∏≤‡∏á headers ‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á
               $('table').append(`<tr class="badge-warning" id="tableHeaders"></tr>`)
                 tableHeaders.forEach(header => {
               $('#tableHeaders').append(`<th>${header}</th>`)
            })

            let gpa = 0 
            let rowArray = tableData.find(row => 
                row[0].toString().toLowerCase() == search.toLowerCase()) 
            if (rowArray != null) { 
                $('#resultdiv').show() 
           
                $('#nameCell').append(`<td colspan="4" style="font-size:15px"> ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á : ${rowArray[1]}</td>`)
                 
                $('#url').attr('href', rowArray[rowArray.length - 2])
                
                rowArray.forEach((col, j) => {
               
                    if (tableData[0][j] == '‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢') gpa = col 
                    
                    if (j > 1 && j < rowArray.length - 3) { 

                          $('table').append(`<tr id="TR${tableData[0][j]}"></tr>`)
                        $('#TR' + tableData[0][j]).append(`<td style="width:15%">${tableData[1][j]}</td>`)
                        $('#TR' + tableData[0][j]).append(`<td>${tableData[0][j]}</td>`)
                        $('#TR' + tableData[0][j]).append(`<td>${col}</td>`)
                    }
                })
                
            } else {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á')
                $('#resultdiv').hide()
            }
        })

        function createTable(data) { 
            tableData = data
        }
        document.getElementById('search').addEventListener("keyup", function (event) {
                // Number 13 is the "Enter" key on the keyboard
                if (event.keyCode === 13) {
                    // Cancel the default action, if needed
                    event.preventDefault();
                    // Trigger the button element with a click
                    document.getElementById("searchButton").click();
                }
            });
    </script>
</body>

</html>
